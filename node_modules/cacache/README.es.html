<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README.es</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="cacache-npm-version-license-travis-appveyor-coverage-status">cacache <a href="https://npm.im/cacache"><img src="https://img.shields.io/npm/v/cacache.svg" alt="npm version" /></a> <a href="https://npm.im/cacache"><img src="https://img.shields.io/npm/l/cacache.svg" alt="license" /></a> <a href="https://travis-ci.org/zkat/cacache"><img src="https://img.shields.io/travis/zkat/cacache.svg" alt="Travis" /></a> <a href="https://ci.appveyor.com/project/zkat/cacache"><img src="https://ci.appveyor.com/api/projects/status/github/zkat/cacache?svg=true" alt="AppVeyor" /></a> <a href="https://coveralls.io/github/zkat/cacache?branch=latest"><img src="https://coveralls.io/repos/github/zkat/cacache/badge.svg?branch=latest" alt="Coverage Status" /></a></h1>
<p><a href="https://github.com/zkat/cacache"><code>cacache</code></a> es una librer√≠a de Node.js para manejar caches locales en disco, con acceso tanto con claves √∫nicas como direcciones de contenido (hashes/hacheos). Es s√∫per r√°pida, excelente con el acceso concurrente, y jam√°s te dar√° datos incorrectos, a√∫n si se corrompen o manipulan directamente los ficheros del cache.</p>
<p>El prop√≥sito original era reemplazar el cach√© local de <a href="https://npm.im/npm">npm</a>, pero se puede usar por su propia cuenta.</p>
<p><em>Traducciones: <a href="README.md">English</a></em></p>
<h2 id="instalaci√≥n">Instalaci√≥n</h2>
<p><code>$ npm install --save cacache</code></p>
<h2 id="√≠ndice">√çndice</h2>
<ul>
<li><a href="#ejemplo">Ejemplo</a></li>
<li><a href="#caracter√≠sticas">Caracter√≠sticas</a></li>
<li><a href="#c√≥mo-contribuir">C√≥mo Contribuir</a></li>
<li><a href="#api">API</a>
<ul>
<li><a href="#localized-api">Usando el API en espa√±ol</a></li>
<li>Leer
<ul>
<li><a href="#ls"><code>ls</code></a></li>
<li><a href="#ls-stream"><code>ls.flujo</code></a></li>
<li><a href="#get-data"><code>saca</code></a></li>
<li><a href="#get-stream"><code>saca.flujo</code></a></li>
<li><a href="#get-info"><code>saca.info</code></a></li>
<li><a href="#get-hasContent"><code>saca.tieneDatos</code></a></li>
</ul></li>
<li>Escribir
<ul>
<li><a href="#put-data"><code>mete</code></a></li>
<li><a href="#put-stream"><code>mete.flujo</code></a></li>
<li><a href="#put-options">opciones para <code>mete*</code></a></li>
<li><a href="#rm-all"><code>rm.todo</code></a></li>
<li><a href="#rm-entry"><code>rm.entrada</code></a></li>
<li><a href="#rm-content"><code>rm.datos</code></a></li>
</ul></li>
<li>Utilidades
<ul>
<li><a href="#set-locale"><code>ponLenguaje</code></a></li>
<li><a href="#clear-memoized"><code>limpiaMemoizado</code></a></li>
<li><a href="#tmp-mkdir"><code>tmp.hazdir</code></a></li>
<li><a href="#with-tmp"><code>tmp.conTmp</code></a></li>
</ul></li>
<li>Integridad
<ul>
<li><a href="#integrity">Subresource Integrity</a></li>
<li><a href="#verify"><code>verifica</code></a></li>
<li><a href="#verify-last-run"><code>verifica.ultimaVez</code></a></li>
</ul></li>
</ul></li>
</ul>
<h3 id="ejemplo">Ejemplo</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> cacache <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;cacache/es&#39;</span>)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> fs <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;fs&#39;</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">const</span> tarbol <span class="op">=</span> <span class="st">&#39;/ruta/a/mi-tar.tgz&#39;</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">const</span> rutaCache <span class="op">=</span> <span class="st">&#39;/tmp/my-toy-cache&#39;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">const</span> clave <span class="op">=</span> <span class="st">&#39;mi-clave-√∫nica-1234&#39;</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">// ¬°A√±√°delo al cach√©! Usa `rutaCache` como ra√≠z del cach√©.</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="va">cacache</span>.<span class="at">mete</span>(rutaCache<span class="op">,</span> clave<span class="op">,</span> <span class="st">&#39;10293801983029384&#39;</span>).<span class="at">then</span>(integrity <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-10" title="10">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Saved content to </span><span class="sc">${</span>rutaCache<span class="sc">}</span><span class="vs">.`</span>)</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-12" title="12"></a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">const</span> destino <span class="op">=</span> <span class="st">&#39;/tmp/mytar.tgz&#39;</span></a>
<a class="sourceLine" id="cb1-14" title="14"></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="co">// Copia el contenido del cach√© a otro fichero, pero esta vez con flujos.</span></a>
<a class="sourceLine" id="cb1-16" title="16"><span class="va">cacache</span>.<span class="va">saca</span>.<span class="at">flujo</span>(</a>
<a class="sourceLine" id="cb1-17" title="17">  rutaCache<span class="op">,</span> clave</a>
<a class="sourceLine" id="cb1-18" title="18">).<span class="at">pipe</span>(</a>
<a class="sourceLine" id="cb1-19" title="19">  <span class="va">fs</span>.<span class="at">createWriteStream</span>(destino)</a>
<a class="sourceLine" id="cb1-20" title="20">).<span class="at">on</span>(<span class="st">&#39;finish&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-21" title="21">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;extracci√≥n completada&#39;</span>)</a>
<a class="sourceLine" id="cb1-22" title="22"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-23" title="23"></a>
<a class="sourceLine" id="cb1-24" title="24"><span class="co">// La misma cosa, pero accesando el contenido directamente, sin tocar el √≠ndice.</span></a>
<a class="sourceLine" id="cb1-25" title="25"><span class="va">cacache</span>.<span class="va">saca</span>.<span class="at">porHacheo</span>(rutaCache<span class="op">,</span> integridad).<span class="at">then</span>(datos <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-26" title="26">  <span class="va">fs</span>.<span class="at">writeFile</span>(destino<span class="op">,</span> datos<span class="op">,</span> err <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-27" title="27">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;datos del tarbol sacados basado en su sha512, y escrito a otro fichero&#39;</span>)</a>
<a class="sourceLine" id="cb1-28" title="28">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb1-29" title="29"><span class="op">}</span>)</a></code></pre></div>
<h3 id="caracter√≠sticas">Caracter√≠sticas</h3>
<ul>
<li>Extracci√≥n por clave o por direcci√≥n de contenido (shasum, etc)</li>
<li>Usa el est√°ndard de web, <a href="#integrity">Subresource Integrity</a></li>
<li>Compatible con multiples algoritmos - usa sha1, sha512, etc, en el mismo cach√© sin problema</li>
<li>Entradas con contenido id√©ntico comparten ficheros</li>
<li>Tolerancia de fallas (inmune a corrupci√≥n, ficheros parciales, carreras de proceso, etc)</li>
<li>Verificaci√≥n completa de datos cuando (escribiendo y leyendo)</li>
<li>Concurrencia r√°pida, segura y ‚Äúlockless‚Äù</li>
<li>Compatible con <code>stream</code>s (flujos)</li>
<li>Compatible con <code>Promise</code>s (promesas)</li>
<li>Bastante r√°pida ‚Äì acceso, incluyendo verificaci√≥n, en microsegundos</li>
<li>Almacenaje de metadatos arbitrarios</li>
<li>Colecci√≥n de basura y verificaci√≥n adicional fuera de banda</li>
<li>Cobertura rigurosa de pruebas</li>
<li>Probablente hay un ‚ÄúBloom filter‚Äù por ah√≠ en alg√∫n lado. Eso le mola a la gente, ¬øVerdad? ü§î</li>
</ul>
<h3 id="c√≥mo-contribuir">C√≥mo Contribuir</h3>
<p>El equipo de cacache felizmente acepta contribuciones de c√≥digo y otras maneras de participaci√≥n. ¬°Hay muchas formas diferentes de contribuir! La <a href="CONTRIBUTING.md">Gu√≠a de Colaboradores</a> (en ingl√©s) tiene toda la informaci√≥n que necesitas para cualquier tipo de contribuci√≥n: todo desde c√≥mo reportar errores hasta c√≥mo someter parches con nuevas caracter√≠sticas. Con todo y eso, no se preocupe por si lo que haces est√° ex√°ctamente correcto: no hay ning√∫n problema en hacer preguntas si algo no est√° claro, o no lo encuentras.</p>
<p>El equipo de cacache tiene miembros hispanohablantes: es completamente aceptable crear <code>issues</code> y <code>pull requests</code> en espa√±ol/castellano.</p>
<p>Todos los participantes en este proyecto deben obedecer el <a href="CODE_OF_CONDUCT.md">C√≥digo de Conducta</a> (en ingl√©s), y en general actuar de forma amable y respetuosa mientras participan en esta comunidad.</p>
<p>Por favor refi√©rase al <a href="CHANGELOG.md">Historial de Cambios</a> (en ingl√©s) para detalles sobre cambios importantes inclu√≠dos en cada versi√≥n.</p>
<p>Finalmente, cacache tiene un sistema de localizaci√≥n de lenguaje. Si te interesa a√±adir lenguajes o mejorar los que existen, mira en el directorio <code>./locales</code> para comenzar.</p>
<p>Happy hacking!</p>
<h3 id="api">API</h3>
<h4 id="usando-el-api-en-espa√±ol"><a name="localized-api"></a> Usando el API en espa√±ol</h4>
<p>cacache incluye una traducci√≥n completa de su API al castellano, con las mismas caracter√≠sticas. Para usar el API como est√° documentado en este documento, usa <code>require('cacache/es')</code></p>
<p>cacache tambi√©n tiene otros lenguajes: encu√©ntralos bajo <code>./locales</code>, y podr√°s usar el API en ese lenguaje con <code>require('cacache/&lt;lenguaje&gt;')</code></p>
<h4 id="cacache.lscache---promiseobject"><a name="ls"></a> <code>&gt; cacache.ls(cache) -&gt; Promise&lt;Object&gt;</code></h4>
<p>Enumera todas las entradas en el cach√©, dentro de un solo objeto. Cada entrada en el objeto tendr√° como clave la clave √∫nica usada para el √≠ndice, el valor siendo un objeto de <a href="#get-info"><code>saca.info</code></a>.</p>
<h5 id="ejemplo-1">Ejemplo</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">cacache</span>.<span class="at">ls</span>(rutaCache).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">// Salida</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="st">&#39;my-thing&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="dt">key</span><span class="op">:</span> <span class="st">&#39;my-thing&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;sha512-BaSe64/EnCoDED+HAsh==&#39;</span></a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="dt">path</span><span class="op">:</span> <span class="st">&#39;.testcache/content/deadbeef&#39;</span><span class="op">,</span> <span class="co">// unido con `rutaCache`</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="dt">time</span><span class="op">:</span> <span class="dv">12345698490</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="dt">size</span><span class="op">:</span> <span class="dv">4023948</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="dt">metadata</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-11" title="11">      <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;blah&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-12" title="12">      <span class="dt">version</span><span class="op">:</span> <span class="st">&#39;1.2.3&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-13" title="13">      <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;this was once a package but now it is my-thing&#39;</span></a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="op">}</span></a>
<a class="sourceLine" id="cb2-15" title="15">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-16" title="16">  <span class="st">&#39;other-thing&#39;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="dt">key</span><span class="op">:</span> <span class="st">&#39;other-thing&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-18" title="18">    <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;sha1-ANothER+hasH=&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-19" title="19">    <span class="dt">path</span><span class="op">:</span> <span class="st">&#39;.testcache/content/bada55&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-20" title="20">    <span class="dt">time</span><span class="op">:</span> <span class="dv">11992309289</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-21" title="21">    <span class="dt">size</span><span class="op">:</span> <span class="dv">111112</span></a>
<a class="sourceLine" id="cb2-22" title="22">  <span class="op">}</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="op">}</span></a></code></pre></div>
<h4 id="cacache.ls.flujocache---readable"><a name="ls-stream"></a> <code>&gt; cacache.ls.flujo(cache) -&gt; Readable</code></h4>
<p>Enumera todas las entradas en el cach√©, emitiendo un objeto de <a href="#get-info"><code>saca.info</code></a> por cada evento de <code>data</code> en el flujo.</p>
<h5 id="ejemplo-2">Ejemplo</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="va">cacache</span>.<span class="va">ls</span>.<span class="at">flujo</span>(rutaCache).<span class="at">on</span>(<span class="st">&#39;data&#39;</span><span class="op">,</span> <span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">// Salida</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="dt">key</span><span class="op">:</span> <span class="st">&#39;my-thing&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;sha512-BaSe64HaSh&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="dt">path</span><span class="op">:</span> <span class="st">&#39;.testcache/content/deadbeef&#39;</span><span class="op">,</span> <span class="co">// unido con `rutaCache`</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="dt">time</span><span class="op">:</span> <span class="dv">12345698490</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="dt">size</span><span class="op">:</span> <span class="dv">13423</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="dt">metadata</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-10" title="10">    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;blah&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-11" title="11">    <span class="dt">version</span><span class="op">:</span> <span class="st">&#39;1.2.3&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-12" title="12">    <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;this was once a package but now it is my-thing&#39;</span></a>
<a class="sourceLine" id="cb3-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="op">{</span></a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="dt">key</span><span class="op">:</span> <span class="st">&#39;other-thing&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-18" title="18">  <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;whirlpool-WoWSoMuchSupport&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-19" title="19">  <span class="dt">path</span><span class="op">:</span> <span class="st">&#39;.testcache/content/bada55&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-20" title="20">  <span class="dt">time</span><span class="op">:</span> <span class="dv">11992309289</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-21" title="21">  <span class="dt">size</span><span class="op">:</span> <span class="dv">498023984029</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="op">}</span></a>
<a class="sourceLine" id="cb3-23" title="23"></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="op">{</span></a>
<a class="sourceLine" id="cb3-25" title="25">  ...</a>
<a class="sourceLine" id="cb3-26" title="26"><span class="op">}</span></a></code></pre></div>
<h4 id="cacache.sacacache-clave-ops---promisedata-metadata-integrity"><a name="get-data"></a> <code>&gt; cacache.saca(cache, clave, [ops]) -&gt; Promise({data, metadata, integrity})</code></h4>
<p>Devuelve un objeto con los datos, hacheo de integridad y metadatos identificados por la <code>clave</code>. La propiedad <code>data</code> de este objeto ser√° una instancia de <code>Buffer</code> con los datos almacenados en el cach√©. to do with it! cacache just won‚Äôt care.</p>
<p><code>integrity</code> es un <code>string</code> de <a href="#integrity">Subresource Integrity</a>. D√≠gase, un <code>string</code> que puede ser usado para verificar a la <code>data</code>, que tiene como formato <code>&lt;algoritmo&gt;-&lt;hacheo-integridad-base64&gt;</code>.</p>
<p>So no existe ninguna entrada identificada por <code>clave</code>, o se los datos almacenados localmente fallan verificaci√≥n, el <code>Promise</code> fallar√°.</p>
<p>Una sub-funci√≥n, <code>saca.porHacheo</code>, tiene casi el mismo comportamiento, excepto que busca entradas usando el hacheo de integridad, sin tocar el √≠ndice general. Esta versi√≥n <em>s√≥lo</em> devuelve <code>data</code>, sin ning√∫n objeto conteni√©ndola.</p>
<h5 id="nota">Nota</h5>
<p>Esta funci√≥n lee la entrada completa a la memoria antes de devolverla. Si est√°s almacenando datos Muy Grandes, es posible que <a href="#get-stream"><code>saca.flujo</code></a> sea una mejor soluci√≥n.</p>
<h5 id="ejemplo-3">Ejemplo</h5>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="co">// Busca por clave</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="va">cache</span>.<span class="at">saca</span>(rutaCache<span class="op">,</span> <span class="st">&#39;my-thing&#39;</span>).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"><span class="co">// Salida:</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="op">{</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="dt">metadata</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="dt">thingName</span><span class="op">:</span> <span class="st">&#39;my&#39;</span></a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="op">},</span></a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;sha512-BaSe64HaSh&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="dt">data</span><span class="op">:</span> Buffer#<span class="op">&lt;</span>deadbeef<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="dt">size</span><span class="op">:</span> <span class="dv">9320</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">// Busca por hacheo</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="va">cache</span>.<span class="va">saca</span>.<span class="at">porHacheo</span>(rutaCache<span class="op">,</span> <span class="st">&#39;sha512-BaSe64HaSh&#39;</span>).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co">// Salida:</span></a>
<a class="sourceLine" id="cb4-16" title="16">Buffer#<span class="op">&lt;</span>deadbeef<span class="op">&gt;</span></a></code></pre></div>
<h4 id="cacache.saca.flujocache-clave-ops---readable"><a name="get-stream"></a> <code>&gt; cacache.saca.flujo(cache, clave, [ops]) -&gt; Readable</code></h4>
<p>Devuelve un <a href="https://nodejs.org/api/stream.html#stream_readable_streams">Readable Stream</a> de los datos almacenados bajo <code>clave</code>.</p>
<p>So no existe ninguna entrada identificada por <code>clave</code>, o se los datos almacenados localmente fallan verificaci√≥n, el <code>Promise</code> fallar√°.</p>
<p><code>metadata</code> y <code>integrity</code> ser√°n emitidos como eventos antes de que el flujo cierre.</p>
<p>Una sub-funci√≥n, <code>saca.flujo.porHacheo</code>, tiene casi el mismo comportamiento, excepto que busca entradas usando el hacheo de integridad, sin tocar el √≠ndice general. Esta versi√≥n no emite eventos de <code>metadata</code> o <code>integrity</code>.</p>
<h5 id="ejemplo-4">Ejemplo</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="co">// Busca por clave</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">cache</span>.<span class="va">saca</span>.<span class="at">flujo</span>(</a>
<a class="sourceLine" id="cb5-3" title="3">  rutaCache<span class="op">,</span> <span class="st">&#39;my-thing&#39;</span></a>
<a class="sourceLine" id="cb5-4" title="4">).<span class="at">on</span>(<span class="st">&#39;metadata&#39;</span><span class="op">,</span> metadata <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;metadata:&#39;</span><span class="op">,</span> metadata)</a>
<a class="sourceLine" id="cb5-6" title="6"><span class="op">}</span>).<span class="at">on</span>(<span class="st">&#39;integrity&#39;</span><span class="op">,</span> integrity <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;integrity:&#39;</span><span class="op">,</span> integrity)</a>
<a class="sourceLine" id="cb5-8" title="8"><span class="op">}</span>).<span class="at">pipe</span>(</a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="va">fs</span>.<span class="at">createWriteStream</span>(<span class="st">&#39;./x.tgz&#39;</span>)</a>
<a class="sourceLine" id="cb5-10" title="10">)</a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">// Salidas:</span></a>
<a class="sourceLine" id="cb5-12" title="12">metadata<span class="op">:</span> <span class="op">{</span> ... <span class="op">}</span></a>
<a class="sourceLine" id="cb5-13" title="13">integrity<span class="op">:</span> <span class="st">&#39;sha512-SoMeDIGest+64==&#39;</span></a>
<a class="sourceLine" id="cb5-14" title="14"></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">// Busca por hacheo</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="va">cache</span>.<span class="va">saca</span>.<span class="va">flujo</span>.<span class="at">porHacheo</span>(</a>
<a class="sourceLine" id="cb5-17" title="17">  rutaCache<span class="op">,</span> <span class="st">&#39;sha512-SoMeDIGest+64==&#39;</span></a>
<a class="sourceLine" id="cb5-18" title="18">).<span class="at">pipe</span>(</a>
<a class="sourceLine" id="cb5-19" title="19">  <span class="va">fs</span>.<span class="at">createWriteStream</span>(<span class="st">&#39;./x.tgz&#39;</span>)</a>
<a class="sourceLine" id="cb5-20" title="20">)</a></code></pre></div>
<h4 id="cacache.saca.infocache-clave---promise"><a name="get-info"></a> <code>&gt; cacache.saca.info(cache, clave) -&gt; Promise</code></h4>
<p>Busca la <code>clave</code> en el √≠ndice del cach√©, devolviendo informaci√≥n sobre la entrada si existe.</p>
<h5 id="campos">Campos</h5>
<ul>
<li><code>key</code> - Clave de la entrada. Igual al argumento <code>clave</code>.</li>
<li><code>integrity</code> - <a href="#integrity">hacheo de Subresource Integrity</a> del contenido al que se refiere esta entrada.</li>
<li><code>path</code> - Direcci√≥n del fichero de datos almacenados, unida al argumento <code>cache</code>.</li>
<li><code>time</code> - Hora de creaci√≥n de la entrada</li>
<li><code>metadata</code> - Metadatos asignados a esta entrada por el usuario</li>
</ul>
<h5 id="ejemplo-5">Ejemplo</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="va">cacache</span>.<span class="va">saca</span>.<span class="at">info</span>(rutaCache<span class="op">,</span> <span class="st">&#39;my-thing&#39;</span>).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">// Salida</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="dt">key</span><span class="op">:</span> <span class="st">&#39;my-thing&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="dt">integrity</span><span class="op">:</span> <span class="st">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span></a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="dt">path</span><span class="op">:</span> <span class="st">&#39;.testcache/content/deadbeef&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="dt">time</span><span class="op">:</span> <span class="dv">12345698490</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="dt">size</span><span class="op">:</span> <span class="dv">849234</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-10" title="10">  <span class="dt">metadata</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-11" title="11">    <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;blah&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-12" title="12">    <span class="dt">version</span><span class="op">:</span> <span class="st">&#39;1.2.3&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-13" title="13">    <span class="dt">description</span><span class="op">:</span> <span class="st">&#39;this was once a package but now it is my-thing&#39;</span></a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="op">}</span></a></code></pre></div>
<h4 id="cacache.saca.tienedatoscache-integrity---promise"><a name="get-hasContent"></a> <code>&gt; cacache.saca.tieneDatos(cache, integrity) -&gt; Promise</code></h4>
<p>Busca un <a href="#integrity">hacheo Subresource Integrity</a> en el cach√©. Si existe el contenido asociado con <code>integrity</code>, devuelve un objeto con dos campos: el hacheo <em>espec√≠fico</em> que se us√≥ para la b√∫squeda, <code>sri</code>, y el tama√±o total del contenido, <code>size</code>. Si no existe ning√∫n contenido asociado con <code>integrity</code>, devuelve <code>false</code>.</p>
<h5 id="ejemplo-6">Ejemplo</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="va">cacache</span>.<span class="va">saca</span>.<span class="at">tieneDatos</span>(rutaCache<span class="op">,</span> <span class="st">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span>).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">// Salida</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="op">{</span></a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="dt">sri</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-6" title="6">    <span class="dt">source</span><span class="op">:</span> <span class="st">&#39;sha256-MUSTVERIFY+ALL/THINGS==&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-7" title="7">    <span class="dt">algorithm</span><span class="op">:</span> <span class="st">&#39;sha256&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="dt">digest</span><span class="op">:</span> <span class="st">&#39;MUSTVERIFY+ALL/THINGS==&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-9" title="9">    <span class="dt">options</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="op">},</span></a>
<a class="sourceLine" id="cb7-11" title="11">  <span class="dt">size</span><span class="op">:</span> <span class="dv">9001</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb7-13" title="13"></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="va">cacache</span>.<span class="va">saca</span>.<span class="at">tieneDatos</span>(rutaCache<span class="op">,</span> <span class="st">&#39;sha521-NOT+IN/CACHE==&#39;</span>).<span class="at">then</span>(<span class="va">console</span>.<span class="at">log</span>)</a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">// Salida</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="kw">false</span></a></code></pre></div>
<h4 id="cacache.metecache-clave-datos-ops---promise"><a name="put-data"></a> <code>&gt; cacache.mete(cache, clave, datos, [ops]) -&gt; Promise</code></h4>
<p>Inserta <code>datos</code> en el cach√©. El <code>Promise</code> devuelto se resuelve con un hacheo (generado conforme a <a href="#optsalgorithms"><code>ops.algorithms</code></a>) despu√©s que la entrada haya sido escrita en completo.</p>
<h5 id="ejemplo-7">Ejemplo</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="at">fetch</span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="st">&#39;https://registry.npmjs.org/cacache/-/cacache-1.0.0.tgz&#39;</span></a>
<a class="sourceLine" id="cb8-3" title="3">).<span class="at">then</span>(datos <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="cf">return</span> <span class="va">cacache</span>.<span class="at">mete</span>(rutaCache<span class="op">,</span> <span class="st">&#39;registry.npmjs.org|cacache@1.0.0&#39;</span><span class="op">,</span> datos)</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="op">}</span>).<span class="at">then</span>(integridad <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-6" title="6">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;el hacheo de integridad es&#39;</span><span class="op">,</span> integridad)</a>
<a class="sourceLine" id="cb8-7" title="7"><span class="op">}</span>)</a></code></pre></div>
<h4 id="cacache.mete.flujocache-clave-ops---writable"><a name="put-stream"></a> <code>&gt; cacache.mete.flujo(cache, clave, [ops]) -&gt; Writable</code></h4>
<p>Devuelve un <a href="https://nodejs.org/api/stream.html#stream_writable_streams">Writable Stream</a> que inserta al cach√© los datos escritos a √©l. Emite un evento <code>integrity</code> con el hacheo del contenido escrito, cuando completa.</p>
<h5 id="ejemplo-8">Ejemplo</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="va">request</span>.<span class="at">get</span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="st">&#39;https://registry.npmjs.org/cacache/-/cacache-1.0.0.tgz&#39;</span></a>
<a class="sourceLine" id="cb9-3" title="3">).<span class="at">pipe</span>(</a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="va">cacache</span>.<span class="va">mete</span>.<span class="at">flujo</span>(</a>
<a class="sourceLine" id="cb9-5" title="5">    rutaCache<span class="op">,</span> <span class="st">&#39;registry.npmjs.org|cacache@1.0.0&#39;</span></a>
<a class="sourceLine" id="cb9-6" title="6">  ).<span class="at">on</span>(<span class="st">&#39;integrity&#39;</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`integrity digest is </span><span class="sc">${</span>d<span class="sc">}</span><span class="vs">`</span>))</a>
<a class="sourceLine" id="cb9-7" title="7">)</a></code></pre></div>
<h4 id="opciones-para-cacache.mete"><a name="put-options"></a> <code>&gt; opciones para cacache.mete</code></h4>
<p>La funciones <code>cacache.mete</code> tienen un n√∫mero de opciones en com√∫n.</p>
<h5 id="ops.metadata"><code>ops.metadata</code></h5>
<p>Metadatos del usuario que se almacenar√°n con la entrada.</p>
<h5 id="ops.size"><code>ops.size</code></h5>
<p>El tama√±o declarado de los datos que se van a insertar. Si es prove√≠do, cacache verificar√° que los datos escritos sean de ese tama√±o, o si no, fallar√° con un error con c√≥digo <code>EBADSIZE</code>.</p>
<h5 id="ops.integrity"><code>ops.integrity</code></h5>
<p>El hacheo de integridad de los datos siendo escritos.</p>
<p>Si es prove√≠do, y los datos escritos no le corresponden, la operaci√≥n fallar√° con un error con c√≥digo <code>EINTEGRITY</code>.</p>
<p><code>ops.algorithms</code> no tiene ning√∫n efecto si esta opci√≥n est√° presente.</p>
<h5 id="ops.algorithms"><code>ops.algorithms</code></h5>
<p>Por Defecto: <code>['sha512']</code></p>
<p>Algoritmos que se deben usar cuando se calcule el hacheo de <a href="#integrity">subresource integrity</a> para los datos insertados. Puede usar cualquier algoritmo enumerado en <code>crypto.getHashes()</code>.</p>
<p>Por el momento, s√≥lo se acepta un algoritmo (d√≠gase, un array con ex√°ctamente un valor). No tiene ning√∫n efecto si <code>ops.integrity</code> tambi√©n ha sido proveido.</p>
<h5 id="ops.uidops.gid"><code>ops.uid</code>/<code>ops.gid</code></h5>
<p>Si est√°n presentes, cacache har√° todo lo posible para asegurarse que todos los ficheros creados en el proceso de sus operaciones en el cach√© usen esta combinaci√≥n en particular.</p>
<h5 id="ops.memoize"><code>ops.memoize</code></h5>
<p>Por Defecto: <code>null</code></p>
<p>Si es verdad, cacache tratar√° de memoizar los datos de la entrada en memoria. La pr√≥xima vez que el proceso corriente trate de accesar los datos o entrada, cacache buscar√° en memoria antes de buscar en disco.</p>
<p>Si <code>ops.memoize</code> es un objeto regular o un objeto como <code>Map</code> (es decir, un objeto con m√©todos <code>get()</code> y <code>set()</code>), este objeto en s√≠ sera usado en vez del cach√© de memoria global. Esto permite tener l√≥gica espec√≠fica a tu aplicaci√≥n encuanto al almacenaje en memoria de tus datos.</p>
<p>Si quieres asegurarte que los datos se lean del disco en vez de memoria, usa <code>memoize: false</code> cuando uses funciones de <code>cacache.saca</code>.</p>
<h4 id="cacache.rm.todocache---promise"><a name="rm-all"></a> <code>&gt; cacache.rm.todo(cache) -&gt; Promise</code></h4>
<p>Borra el cach√© completo, incluyendo ficheros temporeros, ficheros de datos, y el √≠ndice del cach√©.</p>
<h5 id="ejemplo-9">Ejemplo</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="va">cacache</span>.<span class="va">rm</span>.<span class="at">todo</span>(rutaCache).<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;THE APOCALYPSE IS UPON US üò±&#39;</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h4 id="cacache.rm.entradacache-clave---promise"><a name="rm-entry"></a> <code>&gt; cacache.rm.entrada(cache, clave) -&gt; Promise</code></h4>
<p>Alias: <code>cacache.rm</code></p>
<p>Borra la entrada <code>clave</code> del √≠nduce. El contenido asociado con esta entrada seguir√° siendo accesible por hacheo usando <a href="#get-stream"><code>saca.flujo.porHacheo</code></a>.</p>
<p>Para borrar el contenido en s√≠, usa <a href="#rm-content"><code>rm.datos</code></a>. Si quieres hacer esto de manera m√°s segura (pues ficheros de contenido pueden ser usados por multiples entradas), usa <a href="#verify"><code>verifica</code></a> para borrar hu√©rfanos.</p>
<h5 id="ejemplo-10">Ejemplo</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="va">cacache</span>.<span class="va">rm</span>.<span class="at">entrada</span>(rutaCache<span class="op">,</span> <span class="st">&#39;my-thing&#39;</span>).<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;I did not like it anyway&#39;</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h4 id="cacache.rm.datoscache-integrity---promise"><a name="rm-content"></a> <code>&gt; cacache.rm.datos(cache, integrity) -&gt; Promise</code></h4>
<p>Borra el contenido identificado por <code>integrity</code>. Cualquier entrada que se refiera a este contenido quedar√°n hu√©rfanas y se invalidar√°n si se tratan de accesar, al menos que contenido id√©ntico sea a√±adido bajo <code>integrity</code>.</p>
<h5 id="ejemplo-11">Ejemplo</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="va">cacache</span>.<span class="va">rm</span>.<span class="at">datos</span>(rutaCache<span class="op">,</span> <span class="st">&#39;sha512-SoMeDIGest/IN+BaSE64==&#39;</span>).<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;los datos para `mi-cosa` se borraron&#39;</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h4 id="cacache.ponlenguajelocale"><a name="set-locale"></a> <code>&gt; cacache.ponLenguaje(locale)</code></h4>
<p>Configura el lenguaje usado para mensajes y errores de cacache. La lista de lenguajes disponibles est√° en el directorio <code>./locales</code> del proyecto.</p>
<p><em>Te interesa a√±adir m√°s lenguajes? <a href="CONTRIBUTING.md">Somete un PR</a>!</em></p>
<h4 id="cacache.limpiamemoizado"><a name="clear-memoized"></a> <code>&gt; cacache.limpiaMemoizado()</code></h4>
<p>Completamente reinicializa el cach√© de memoria interno. Si est√°s usando tu propio objecto con <code>ops.memoize</code>, debes hacer esto de manera espec√≠fica a √©l.</p>
<h4 id="tmp.hazdircache-ops---promisepath"><a name="tmp-mkdir"></a> <code>&gt; tmp.hazdir(cache, ops) -&gt; Promise&lt;Path&gt;</code></h4>
<p>Alias: <code>tmp.mkdir</code></p>
<p>Devuelve un directorio √∫nico dentro del directorio <code>tmp</code> del cach√©.</p>
<p>Una vez tengas el directorio, es responsabilidad tuya asegurarte que todos los ficheros escrito a √©l sean creados usando los permisos y <code>uid</code>/<code>gid</code> concordante con el cach√©. Si no, puedes pedirle a cacache que lo haga llamando a <a href="#tmp-fix"><code>cacache.tmp.fix()</code></a>. Esta funci√≥n arreglar√° todos los permisos en el directorio tmp.</p>
<p>Si quieres que cacache limpie el directorio autom√°ticamente cuando termines, usa <a href="#with-tpm"><code>cacache.tmp.conTmp()</code></a>.</p>
<h5 id="ejemplo-12">Ejemplo</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">cacache</span>.<span class="va">tmp</span>.<span class="at">mkdir</span>(cache).<span class="at">then</span>(dir <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="va">fs</span>.<span class="at">writeFile</span>(<span class="va">path</span>.<span class="at">join</span>(dir<span class="op">,</span> <span class="st">&#39;blablabla&#39;</span>)<span class="op">,</span> Buffer#<span class="op">&lt;</span><span class="dv">1234</span><span class="op">&gt;,</span> ...)</a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<h4 id="tmp.contmpcache-ops-cb---promise"><a name="with-tmp"></a> <code>&gt; tmp.conTmp(cache, ops, cb) -&gt; Promise</code></h4>
<p>Crea un directorio temporero con <a href="#tmp-mkdir"><code>tmp.mkdir()</code></a> y ejecuta <code>cb</code> con √©l como primer argumento. El directorio creado ser√° removido autom√°ticamente cuando el valor devolvido por <code>cb()</code> se resuelva.</p>
<p>Las mismas advertencias aplican en cuanto a manejando permisos para los ficheros dentro del directorio.</p>
<h5 id="ejemplo-13">Ejemplo</h5>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="va">cacache</span>.<span class="va">tmp</span>.<span class="at">conTmp</span>(cache<span class="op">,</span> dir <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="cf">return</span> <span class="va">fs</span>.<span class="at">writeFileAsync</span>(<span class="va">path</span>.<span class="at">join</span>(dir<span class="op">,</span> <span class="st">&#39;blablabla&#39;</span>)<span class="op">,</span> Buffer#<span class="op">&lt;</span><span class="dv">1234</span><span class="op">&gt;,</span> ...)</a>
<a class="sourceLine" id="cb14-3" title="3"><span class="op">}</span>).<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="co">// `dir` no longer exists</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">}</span>)</a></code></pre></div>
<h4 id="hacheos-de-subresource-integrity"><a name="integrity"></a> Hacheos de Subresource Integrity</h4>
<p>cacache usa strings que siguen la especificaci√≥n de <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">Subresource Integrity spec</a>.</p>
<p>Es decir, donde quiera cacache espera un argumento o opci√≥n <code>integrity</code>, ese string deber√≠a usar el formato <code>&lt;algoritmo&gt;-&lt;hacheo-base64&gt;</code>.</p>
<p>Una variaci√≥n importante sobre los hacheos que cacache acepta es que acepta el nombre de cualquier algoritmo aceptado por el proceso de Node.js donde se usa. Puedes usar <code>crypto.getHashes()</code> para ver cuales est√°n disponibles.</p>
<h5 id="generando-tus-propios-hacheos">Generando tus propios hacheos</h5>
<p>Si tienes un <code>shasum</code>, en general va a estar en formato de string hexadecimal (es decir, un <code>sha1</code> se ver√≠a como algo as√≠: <code>5f5513f8822fdbe5145af33b64d8d970dcf95c6e</code>).</p>
<p>Para ser compatible con cacache, necesitas convertir esto a su equivalente en subresource integrity. Por ejemplo, el hacheo correspondiente al ejemplo anterior ser√≠a: <code>sha1-X1UT+IIv2+UUWvM7ZNjZcNz5XG4=</code>.</p>
<p>Puedes usar c√≥digo as√≠ para generarlo por tu cuenta:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">const</span> crypto <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;crypto&#39;</span>)</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">const</span> algoritmo <span class="op">=</span> <span class="st">&#39;sha512&#39;</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">const</span> datos <span class="op">=</span> <span class="st">&#39;foobarbaz&#39;</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="kw">const</span> integrity <span class="op">=</span> (</a>
<a class="sourceLine" id="cb15-6" title="6">  algorithm <span class="op">+</span></a>
<a class="sourceLine" id="cb15-7" title="7">  <span class="st">&#39;-&#39;</span> <span class="op">+</span></a>
<a class="sourceLine" id="cb15-8" title="8">  <span class="va">crypto</span>.<span class="at">createHash</span>(algoritmo).<span class="at">update</span>(datos).<span class="at">digest</span>(<span class="st">&#39;base64&#39;</span>)</a>
<a class="sourceLine" id="cb15-9" title="9">)</a></code></pre></div>
<p>Tambi√©n puedes usar <a href="https://npm.im/ssri"><code>ssri</code></a> para deferir el trabajo a otra librer√≠a que garantiza que todo est√© correcto, pues maneja probablemente todas las operaciones que tendr√≠as que hacer con SRIs, incluyendo convirtiendo entre hexadecimal y el formato SRI.</p>
<h4 id="cacache.verificacache-ops---promise"><a name="verify"></a> <code>&gt; cacache.verifica(cache, ops) -&gt; Promise</code></h4>
<p>Examina y arregla tu cach√©:</p>
<ul>
<li>Limpia entradas inv√°lidas, hu√©rfanas y corrompidas</li>
<li>Te deja filtrar cuales entradas retener, con tu propio filtro</li>
<li>Reclama cualquier ficheros de contenido sin referencias en el √≠ndice</li>
<li>Verifica integridad de todos los ficheros de contenido y remueve los malos</li>
<li>Arregla permisos del cach√©</li>
<li>Remieve el directorio <code>tmp</code> en el cach√©, y todo su contenido.</li>
</ul>
<p>Cuando termine, devuelve un objeto con varias estad√≠sticas sobre el proceso de verificaci√≥n, por ejemplo la cantidad de espacio de disco reclamado, el n√∫mero de entradas v√°lidas, n√∫mero de entradas removidas, etc.</p>
<h5 id="opciones">Opciones</h5>
<ul>
<li><code>ops.uid</code> - uid para asignarle al cach√© y su contenido</li>
<li><code>ops.gid</code> - gid para asignarle al cach√© y su contenido</li>
<li><code>ops.filter</code> - recibe una entrada como argumento. Devuelve falso para removerla. Nota: es posible que esta funci√≥n sea invocada con la misma entrada m√°s de una vez.</li>
</ul>
<h5 id="example">Example</h5>
<div class="sourceCode" id="cb16"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb16-1" title="1"><span class="bu">echo</span> somegarbage <span class="op">&gt;&gt;</span> <span class="va">$RUTACACHE</span>/content/deadbeef</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="va">cacache</span>.<span class="at">verifica</span>(rutaCache).<span class="at">then</span>(stats <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">  <span class="co">// deadbeef collected, because of invalid checksum.</span></a>
<a class="sourceLine" id="cb17-3" title="3">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;cache is much nicer now! stats:&#39;</span><span class="op">,</span> stats)</a>
<a class="sourceLine" id="cb17-4" title="4"><span class="op">}</span>)</a></code></pre></div>
<h4 id="cacache.verifica.ultimavezcache---promise"><a name="verify-last-run"></a> <code>&gt; cacache.verifica.ultimaVez(cache) -&gt; Promise</code></h4>
<p>Alias: <code>√∫ltimaVez</code></p>
<p>Devuelve un <code>Date</code> que representa la √∫ltima vez que <code>cacache.verifica</code> fue ejecutada en <code>cache</code>.</p>
<h5 id="example-1">Example</h5>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="va">cacache</span>.<span class="at">verifica</span>(rutaCache).<span class="at">then</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="va">cacache</span>.<span class="va">verifica</span>.<span class="at">ultimaVez</span>(rutaCache).<span class="at">then</span>(√∫ltima <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-3" title="3">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;La √∫ltima vez que se us√≥ cacache.verifica() fue &#39;</span> <span class="op">+</span> √∫ltima)</a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb18-5" title="5"><span class="op">}</span>)</a></code></pre></div>
</body>
</html>
